<div class="breadcrumb">
    <h1>CosmeTic</h1>
    <ul>
        <li><a href="">Servicios</a></li>
        <li>Comisiones</li>
    </ul>
</div>

<div class="separator-breadcrumb border-top"></div>

<div class="row mb-3">
    <div class="col-md-12 mb-3">
        <div class="row">
            <div class="col-md-6"> 
                <div class="row">
                    <div class="col-md-3">
                        <button class="btn btn-primary float-right" [routerLink]="['/comisiones/registrar']">Crear nueva comisión</button>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-primary float-right" [routerLink]="['/detalleComs/registrar']">Crear nuevo detalle de comisión</button>
                    </div>
                </div>
            </div>
           
            <div class="col-md-6 d-flex justify-content-end">
                <input _ngcontent-vet-c167="" id="email" placeholder="Buscar Comisiones" type="text" class="form-control  ng-valid ng-touched ng-dirty" ng-reflect-form="[object Object]" style="width: 50%;">
            </div>
        </div>
    </div>
    
    
    
    
    
    <div class="col-md-12">
        <div class="card o-hidden">
            <div class="col-md-12">
                <div class="card o-hidden">
                    <ngx-datatable
                        class="material fullscreen"
                        style="height: 460px;"
                        [columnMode]="'force'"
                        [headerHeight]="50"
                        [footerHeight]="50"
                        [rowHeight]="60"
                        [scrollbarV]="true"
                        [rows]="listComissions"
                        [externalPaging]="true"
                        [count]="listComissions.length"
                        [limit]="itemsPerPage"
                        [offset]="(currentPage - 1) * itemsPerPage"
                        (page)="onPageChange($event)">
                        <ngx-datatable-column name="id_employee">
                            <ng-template ngx-datatable-header-template>
                                Empleado
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                {{ employees[row.id_employee] }}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="total_commission">
                            <ng-template ngx-datatable-header-template>
                                Total Comisión
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                {{ row.total_commission }}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="total_sales">
                            <ng-template ngx-datatable-header-template>
                                Total Ventas
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                {{ row.total_sales }}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column name="month_commission">
                            <ng-template ngx-datatable-header-template>
                                Mes Comisión
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                {{ row.month_commission }}
                            </ng-template>
                        </ngx-datatable-column>
                        
                        <ngx-datatable-column name="commission_percentage">
                            <ng-template ngx-datatable-header-template>
                                Porcentaje Comisión
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                {{ row.commission_percentage }}
                            </ng-template>
                        </ngx-datatable-column>
                        <ngx-datatable-column [width]="120">
                            <ng-template ngx-datatable-header-template>
                                Acciones
                            </ng-template>
                            <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
                                <button class="btn btn-dark m-1 me-3" [routerLink]="['/comisiones/detalle', row.id_commission]">
                                    <i class="i-Eye"></i> 
                                </button>
                            </ng-template>
                        </ngx-datatable-column>
                    </ngx-datatable>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Agrega los controles de paginación justo debajo de la tabla -->
<pagination-template
    (pageChange)="pageChanged($event)"
    [id]="paginationId"
    
></pagination-template>

<ng-template #changeStateModal let-modal>
    <div class="modal-header">
        <h4 class="Cambiar estado" id="modal-title">Cambiar Estado del Proveedor</h4>
        <button type="button" class="close" aria-label="Close button" aria-describedby="modal-title"
            (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <p><strong>¿Está seguro de que desea inhabilitar este proveedor?</strong></p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary btn-rounded"
            (click)="modal.dismiss('cancel')">Cancelar</button>
        <button type="button" ngbAutofocus class="btn btn-wide btn-danger btn-rounded"
            (click)="modal.close('Yes')">Aceptar</button>
    </div>
</ng-template>